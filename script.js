        const questions = {
            'very-easy': [
                { text: "ما هو الحد الأقصى لطول الفيديو في تيك توك؟", answers: ["10 دقائق", "3 دقائق", "1 دقيقة", "30 ثانية"], correct: 0 },
                { text: "ما اسم العملة الافتراضية في تيك توك؟", answers: ["عملات تيك توك", "نقاط", "جواهر", "دولارات"], correct: 0 },
                { text: "ما هي ميزة البث المباشر في تيك توك؟", answers: ["لايف", "ستريم", "بث", "مباشر"], correct: 0 },
                { text: "ما اسم الصوت المستخدم في الفيديوهات؟", answers: ["الصوت الأصلي", "الموسيقى", "الأغنية", "الساوند"], correct: 3 },
                { text: "ما رمز الإعجاب في تيك توك؟", answers: ["قلب", "لايك", "نجمة", "إبهام"], correct: 0 },
                { text: "كيف تحفظ فيديو في تيك توك؟", answers: ["زر المشاركة ثم حفظ", "الضغط المطول", "النقر مرتين", "زر التنزيل"], correct: 0 },
                { text: "ما اسم خاصية الفيديوهات القصيرة؟", answers: ["Stories", "Shorts", "Reels", "TikTok"], correct: 3 },
                { text: "ما هو FYP في تيك توك؟", answers: ["For You Page", "Follow Your People", "Find Your Place", "First Year Plan"], correct: 0 },
                { text: "كم ثانية أقل مدة للفيديو؟", answers: ["1 ثانية", "3 ثواني", "5 ثواني", "10 ثواني"], correct: 0 },
                { text: "ما اسم التأثيرات في تيك توك؟", answers: ["فلاتر", "إيفكتس", "تأثيرات", "جميع ما سبق"], correct: 3 }
            ],
            'easy': [
                { text: "في أي سنة تم إطلاق تيك توك عالمياً؟", answers: ["2016", "2017", "2018", "2019"], correct: 1 },
                { text: "كم عدد المتابعين المطلوب للبث المباشر؟", answers: ["100", "500", "1000", "5000"], correct: 2 },
                { text: "ما الشركة المالكة لتيك توك؟", answers: ["ByteDance", "Facebook", "Google", "Amazon"], correct: 0 },
                { text: "ما اسم النسخة الصينية من تيك توك؟", answers: ["Douyin", "WeChat", "Weibo", "QQ"], correct: 0 },
                { text: "كم مرة يمكن تغيير اسم المستخدم؟", answers: ["مرة واحدة كل 30 يوم", "مرة واحدة كل 7 أيام", "غير محدود", "مرة واحدة فقط"], correct: 0 },
                { text: "ما هو الحد الأدنى للعمر لاستخدام تيك توك؟", answers: ["13 سنة", "16 سنة", "18 سنة", "21 سنة"], correct: 0 },
                { text: "كيف تصبح موثقاً في تيك توك؟", answers: ["شراء التوثيق", "التقديم عبر النموذج", "10 آلاف متابع تلقائياً", "لا يمكن"], correct: 1 },
                { text: "ما معنى الشادو بان؟", answers: ["حظر مؤقت", "تقييد الوصول", "حذف الحساب", "تعليق النشر"], correct: 1 },
                { text: "كم عدد الحسابات التي يمكن ربطها برقم واحد؟", answers: ["1", "3", "5", "غير محدود"], correct: 1 },
                { text: "ما اسم برنامج المكافآت للمبدعين؟", answers: ["Creator Fund", "Partner Program", "TikTok Rewards", "Creator Bonus"], correct: 0 }
            ],
            'easy-plus': [
                { text: "كم نسبة تيك توك من أرباح الهدايا؟", answers: ["30%", "40%", "50%", "60%"], correct: 2 },
                { text: "ما الحد الأقصى لعدد الفيديوهات المحفوظة؟", answers: ["100", "500", "1000", "غير محدود"], correct: 3 },
                { text: "كم عدد الهاشتاقات المسموح بها؟", answers: ["50", "100", "150", "200"], correct: 1 },
                { text: "ما اسم خاصية الدويتو؟", answers: ["Duet", "Collab", "Together", "Partner"], correct: 0 },
                { text: "كم ثانية مدة القصة (Story)؟", answers: ["15 ثانية", "24 ساعة", "60 ثانية", "لا توجد قصص"], correct: 1 },
                { text: "ما معنى POV في تيك توك؟", answers: ["Point of View", "People of Victory", "Place of Video", "Post of Value"], correct: 0 },
                { text: "كم الحد الأقصى للبايو؟", answers: ["80 حرف", "100 حرف", "150 حرف", "200 حرف"], correct: 0 },
                { text: "ما أفضل وقت للنشر عربياً؟", answers: ["6-9 صباحاً", "12-3 ظهراً", "6-10 مساءً", "12-3 فجراً"], correct: 2 },
                { text: "كم يوم تبقى القصة نشطة؟", answers: ["1 يوم", "3 أيام", "7 أيام", "30 يوم"], correct: 0 },
                { text: "ما اسم خاصية الرد بالفيديو؟", answers: ["Video Reply", "Stitch", "Response", "React"], correct: 0 }
            ],
            'medium': [
                { text: "ما كان اسم تيك توك السابق؟", answers: ["Musical.ly", "Vine", "Dubsmash", "Snapchat"], correct: 0 },
                { text: "كم عدد المستخدمين النشطين شهرياً 2024؟", answers: ["500 مليون", "800 مليون", "1 مليار", "1.5 مليار+"], correct: 3 },
                { text: "في كم دولة محظور تيك توك؟", answers: ["3", "5", "8", "أكثر من 10"], correct: 3 },
                { text: "ما قيمة أغلى هدية في تيك توك؟", answers: ["1000 عملة", "5000 عملة", "10000 عملة", "35000 عملة"], correct: 3 },
                { text: "كم الحد الأدنى لسحب الأرباح؟", answers: ["10$", "30$", "50$", "100$"], correct: 2 },
                { text: "ما أكثر فيديو مشاهدة في التاريخ؟", answers: ["500 مليون", "1 مليار", "2.2 مليار", "3 مليار+"], correct: 2 },
                { text: "كم عدد الموظفين في تيك توك؟", answers: ["50 ألف", "100 ألف", "150 ألف", "200 ألف+"], correct: 2 },
                { text: "ما نسبة المستخدمين تحت 30 سنة؟", answers: ["40%", "50%", "60%", "70%+"], correct: 3 },
                { text: "كم مليار تنزيل حقق التطبيق؟", answers: ["1 مليار", "2 مليار", "3 مليار", "4 مليار+"], correct: 3 },
                { text: "ما أعلى عدد مشاهدات بث مباشر؟", answers: ["1 مليون", "5 مليون", "10 مليون", "20 مليون+"], correct: 3 }
            ],
            'hard': [
                { text: "من مؤسس ByteDance؟", answers: ["Zhang Yiming", "Jack Ma", "Lei Jun", "Pony Ma"], correct: 0 },
                { text: "كم قيمة تيك توك السوقية 2024؟", answers: ["50 مليار", "100 مليار", "200 مليار", "300 مليار+"], correct: 3 },
                { text: "ما خوارزمية التوصية الرئيسية؟", answers: ["AI Recommendation", "For You Algorithm", "Deep Learning", "جميع ما سبق"], correct: 3 },
                { text: "كم نسبة الفيديوهات التي تصل للـFYP؟", answers: ["1%", "3-5%", "10%", "20%"], correct: 1 },
                { text: "ما أعلى راتب لمؤثر سنوياً؟", answers: ["1 مليون$", "5 مليون$", "10 مليون$", "20 مليون$+"], correct: 3 },
                { text: "كم عدد اللغات المدعومة؟", answers: ["30", "50", "75", "100+"], correct: 2 },
                { text: "ما معدل الوقت اليومي للمستخدم؟", answers: ["30 دقيقة", "52 دقيقة", "90 دقيقة", "120 دقيقة"], correct: 1 },
                { text: "كم عدد الفيديوهات المرفوعة يومياً؟", answers: ["1 مليون", "10 مليون", "50 مليون", "100 مليون+"], correct: 3 },
                { text: "ما نسبة الإيرادات من الإعلانات؟", answers: ["40%", "60%", "80%", "90%+"], correct: 2 },
                { text: "كم سعر العملة الواحدة بالسنت؟", answers: ["0.5 سنت", "1.3 سنت", "2 سنت", "5 سنت"], correct: 1 }
            ]
        };

        const rewards = { 0: 0, 1: 3000, 2: 5000, 3: 7500, 4: 15000, 5: 20000 };
        const difficultyLabels = {
            'very-easy': 'سهل جداً',
            'easy': 'سهل',
            'easy-plus': 'سهل+',
            'medium': 'متوسط',
            'hard': 'صعب'
        };

        // Game State
        let gameState = {
            questions: [],
            currentIndex: 0,
            correctAnswers: 0,
            timer: null,
            timeLeft: 15,
            isAnswering: false
        };

        // Utility Functions
        function shuffle(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function selectQuestions() {
            const difficulties = ['very-easy', 'easy', 'easy-plus', 'medium', 'hard'];
            const selected = [];
            
            difficulties.forEach(diff => {
                const pool = questions[diff];
                const question = pool[Math.floor(Math.random() * pool.length)];
                selected.push({ ...question, difficulty: diff });
            });
            
            return shuffle(selected);
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function vibrate(pattern) {
            if ('vibrate' in navigator) {
                navigator.vibrate(pattern);
            }
        }

        // Game Functions
        function startQuiz() {
            gameState.questions = selectQuestions();
            gameState.currentIndex = 0;
            gameState.correctAnswers = 0;
            gameState.isAnswering = false;
            
            const btn = document.querySelector('.btn');
            const originalText = btn.textContent;
            btn.innerHTML = '<span class="loading"></span>جاري التحضير...';
            btn.disabled = true;
            
            vibrate(100);
            
            setTimeout(() => {
                showScreen('questions-screen');
                showQuestion();
                btn.textContent = originalText;
                btn.disabled = false;
            }, 1200);
        }

        function showQuestion() {
            const question = gameState.questions[gameState.currentIndex];
            
            document.getElementById('question-meta').textContent = 
                `السؤال ${gameState.currentIndex + 1} من 5`;
            document.getElementById('difficulty').textContent = 
                difficultyLabels[question.difficulty];
            document.getElementById('difficulty').className = 
                `difficulty difficulty-${question.difficulty}`;
            document.getElementById('question-text').textContent = question.text;
            
            const answersContainer = document.getElementById('answers');
            answersContainer.innerHTML = '';
            
            question.answers.forEach((answer, index) => {
                const btn = document.createElement('button');
                btn.className = 'answer';
                btn.textContent = answer;
                btn.onclick = () => selectAnswer(index);
                answersContainer.appendChild(btn);
            });
            
            gameState.isAnswering = false;
            startTimer();
        }

        function startTimer() {
            gameState.timeLeft = 15;
            updateTimer();
            
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                updateTimer();
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timer);
                    if (!gameState.isAnswering) {
                        selectAnswer(-1);
                    }
                }
            }, 1000);
        }

        function updateTimer() {
            const progress = (gameState.timeLeft / 15) * 100;
            document.getElementById('timer-fill').style.width = progress + '%';
            document.getElementById('timer-text').textContent = 
                `${gameState.timeLeft} ثانية متبقية`;
        }

        function selectAnswer(selectedIndex) {
            if (gameState.isAnswering) return;
            gameState.isAnswering = true;
            
            clearInterval(gameState.timer);
            
            const question = gameState.questions[gameState.currentIndex];
            const isCorrect = selectedIndex === question.correct;
            
            if (isCorrect) {
                gameState.correctAnswers++;
                vibrate(200);
            } else {
                vibrate([100, 50, 100]);
            }
            
            const buttons = document.querySelectorAll('.answer');
            buttons.forEach((btn, index) => {
                if (index === question.correct) {
                    btn.classList.add('correct');
                } else if (index === selectedIndex && !isCorrect) {
                    btn.classList.add('wrong');
                }
                btn.disabled = true;
            });
            
            setTimeout(() => {
                gameState.currentIndex++;
                if (gameState.currentIndex < 5) {
                    showQuestion();
                } else {
                    showResults();
                }
            }, 1500);
        }

        function showResults() {
            const reward = rewards[gameState.correctAnswers];
            
            document.getElementById('results-subtitle').textContent = 
                `لقد أجبت على ${gameState.correctAnswers} أسئلة بشكل صحيح من أصل 5`;
            document.getElementById('reward-amount').textContent = reward.toLocaleString();
            
            const formSection = document.getElementById('form-section');
            const retryBtn = document.getElementById('retry-btn');
            
            if (reward === 0) {
                formSection.style.display = 'none';
                retryBtn.style.display = 'block';
            } else {
                formSection.style.display = 'block';
                retryBtn.style.display = 'none';
            }
            
            let icon, title;
            
            if (gameState.correctAnswers === 5) {
                icon = '<i class="fas fa-crown" style="color: #ffd700;"></i>';
                title = 'إنجاز مثالي!';
                vibrate([200, 100, 200, 100, 200]);
            } else if (gameState.correctAnswers >= 4) {
                icon = '<i class="fas fa-trophy" style="color: #ffd700;"></i>';
                title = 'أداء ممتاز!';
                vibrate([200, 100, 200]);
            } else if (gameState.correctAnswers >= 3) {
                icon = '<i class="fas fa-medal" style="color: #c0392b;"></i>';
                title = 'أداء جيد جداً!';
                vibrate(200);
            } else if (gameState.correctAnswers >= 2) {
                icon = '<i class="fas fa-award" style="color: #f39c12;"></i>';
                title = 'أداء مقبول!';
            } else if (gameState.correctAnswers >= 1) {
                icon = '<i class="fas fa-star" style="color: #f39c12;"></i>';
                title = 'بداية جيدة!';
            } else {
                icon = '<i class="fas fa-redo" style="color: #95a5a6;"></i>';
                title = 'لا تستسلم!';
            }
            
            document.getElementById('results-icon').innerHTML = icon;
            document.getElementById('results-title').textContent = title;
            
            showScreen('results-screen');
        }

        function retryQuiz() {
            showScreen('intro-screen');
        }

        function submitForm(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const errorEl = document.getElementById('username-error');
            const inputEl = document.getElementById('username');
            const submitBtn = document.getElementById('submit-btn');
            
            errorEl.textContent = '';
            inputEl.classList.remove('error');
            
            if (username.length < 3) {
                errorEl.textContent = 'اسم المستخدم يجب أن يكون 3 أحرف على الأقل';
                inputEl.classList.add('error');
                inputEl.focus();
                return;
            }
            
            if (!/^[a-zA-Z0-9_.]+$/.test(username)) {
                errorEl.textContent = 'يجب أن يحتوي على أحرف وأرقام و نقطة أو _ فقط';
                inputEl.classList.add('error');
                inputEl.focus();
                return;
            }
            
            const originalText = submitBtn.textContent;
            submitBtn.innerHTML = '<span class="loading"></span>جاري المعالجة...';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                vibrate([200, 100, 200]);
                submitBtn.textContent = 'تم بنجاح! جاري التحويل...';
                
                setTimeout(() => {
                    window.open('https://reetools.com', '_blank');
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                }, 1500);
            }, 2000);
        }

        // Event Listeners
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && document.getElementById('intro-screen').classList.contains('active')) {
                startQuiz();
            }
        });

        document.addEventListener('visibilitychange', () => {
            if (document.hidden && gameState.timer) {
                clearInterval(gameState.timer);
            } else if (!document.hidden && gameState.timeLeft > 0 && !gameState.isAnswering) {
                startTimer();
            }
        });
